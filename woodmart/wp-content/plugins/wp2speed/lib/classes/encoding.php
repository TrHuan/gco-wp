<?php
/**
 * Plugin Name: PageSpeed Optimizer
 * Description: Make website faster, speed up page load time and improve performance scores in services like GTmetrix, Pingdom, YSlow and PageSpeed.
 * Version: 2.0.1
 * License: GPL2
*/
 class MMR_Encoding { const ICONV_TRANSLIT = "TRANSLIT"; const ICONV_IGNORE = "IGNORE"; const WITHOUT_ICONV = ""; protected static $win1252ToUtf8 = array(128 => "â‚¬", 130 => "â€š", 131 => "Æ’", 132 => "â€ž", 133 => "â€¦", 134 => "â€ ", 135 => "â€¡", 136 => "Ë†", 137 => "â€°", 138 => "Å ", 139 => "â€¹", 140 => "Å’", 142 => "Å½", 145 => "â€˜", 146 => "â€™", 147 => "â€œ", 148 => "â€", 149 => "â€¢", 150 => "â€“", 151 => "â€”", 152 => "Ëœ", 153 => "â„¢", 154 => "Å¡", 155 => "â€º", 156 => "Å“", 158 => "Å¾", 159 => "Å¸"); protected static $brokenUtf8ToUtf8 = array("Â€" => "â‚¬", "Â‚" => "â€š", "Âƒ" => "Æ’", "Â„" => "â€ž", "Â…" => "â€¦", "Â†" => "â€ ", "Â‡" => "â€¡", "Âˆ" => "Ë†", "Â‰" => "â€°", "ÂŠ" => "Å ", "Â‹" => "â€¹", "ÂŒ" => "Å’", "ÂŽ" => "Å½", "Â‘" => "â€˜", "Â’" => "â€™", "Â“" => "â€œ", "Â”" => "â€", "Â•" => "â€¢", "Â–" => "â€“", "Â—" => "â€”", "Â˜" => "Ëœ", "Â™" => "â„¢", "Âš" => "Å¡", "Â›" => "â€º", "Âœ" => "Å“", "Âž" => "Å¾", "ÂŸ" => "Å¸"); protected static $utf8ToWin1252 = array("â‚¬" => "€", "â€š" => "‚", "Æ’" => "ƒ", "â€ž" => "„", "â€¦" => "…", "â€ " => "†", "â€¡" => "‡", "Ë†" => "ˆ", "â€°" => "‰", "Å " => "Š", "â€¹" => "‹", "Å’" => "Œ", "Å½" => "Ž", "â€˜" => "‘", "â€™" => "’", "â€œ" => "“", "â€" => "”", "â€¢" => "•", "â€“" => "–", "â€”" => "—", "Ëœ" => "˜", "â„¢" => "™", "Å¡" => "š", "â€º" => "›", "Å“" => "œ", "Å¾" => "ž", "Å¸" => "Ÿ"); static function toUTF8($text) { goto PoWMP; rVBvt: W7tRA: goto bp0AN; L7iZo: if ($c1 >= "À") { goto F8CXp; } goto Hy1o6; oJpra: jdvFx: goto mtYth; RI8Mr: DCcbH: goto VjBDL; Hy1o6: if (($c1 & "À") === "€") { goto gL6zi; } goto MYvNS; RrzF9: xhYC7: goto u6r1X; QBMRT: $buf = ""; goto AIVpG; wSdGD: $cc1 = chr(ord($c1) / 64) | "À"; goto AlRDe; BIAN8: goto h97Fq; goto Gei4g; fd_9B: if (isset(self::$win1252ToUtf8[ord($c1)])) { goto AX2aj; } goto obu2w; JJ9h6: gL6zi: goto fd_9B; J_iqG: goto Qbvvo; goto f_StR; LfYML: if ($c2 >= "€" && $c2 <= "¿" && $c3 >= "€" && $c3 <= "¿") { goto ZkKuR; } goto wSdGD; uV979: $c4 = $i + 3 >= $max ? "\0" : $text[$i + 3]; goto ni4M1; po2AJ: $cc2 = $c1 & "?" | "€"; goto isidw; UpqW4: $buf .= $c1 . $c2; goto BUkaM; bap0W: $c1 = $text[$i]; goto L7iZo; ZhePb: $cc1 = chr(ord($c1) / 64) | "À"; goto acAbZ; ni4M1: if ($c1 >= "À" & $c1 <= "ß") { goto DCcbH; } goto fw2uq; wQTJG: fy2YH: goto szWHd; opmXQ: foreach ($text as $k => $v) { $text[$k] = self::toUTF8($v); bKNg3: } goto Te7Og; tu8jL: t5jn6: goto kl1g0; i5Yh7: h4X0f: goto FR4JX; BUzOv: if ($c1 >= "ð" & $c1 <= "÷") { goto jdvFx; } goto ULB6u; FR4JX: return $buf; goto gdbTz; s0szZ: $buf .= self::$win1252ToUtf8[ord($c1)]; goto mOq3L; QAMyN: return $text; goto rVBvt; mSEch: ejarl: goto uZKZj; QiqAx: $cc1 = chr(ord($c1) / 64) | "À"; goto po2AJ; isidw: $buf .= $cc1 . $cc2; goto BIAN8; OcFO8: $i = $i + 2; goto mSEch; seth7: goto pUsU7; goto i5Yh7; uZKZj: goto xhYC7; goto oJpra; f_StR: AX2aj: goto s0szZ; Gei4g: G0H3w: goto UpqW4; fw2uq: if ($c1 >= "à" & $c1 <= "ï") { goto c24DN; } goto BUzOv; u6r1X: goto mG7HE; goto JJ9h6; mOq3L: Qbvvo: goto HPwT0; f10XV: $i = $i + 3; goto Rsyu3; MYvNS: $buf .= $c1; goto GTnP2; Te7Og: mhjsj: goto kuaBz; Rsyu3: OtLUx: goto RrzF9; LXVjF: if (!($i < $max)) { goto h4X0f; } goto bap0W; obu2w: $cc1 = chr(ord($c1) / 64) | "À"; goto VCDcC; acAbZ: $cc2 = $c1 & "?" | "€"; goto u8201; AIVpG: $i = 0; goto UZgrZ; PoWMP: if (!is_array($text)) { goto t5jn6; } goto opmXQ; QoqRB: h97Fq: goto yW82j; VjBDL: if ($c2 >= "€" && $c2 <= "¿") { goto G0H3w; } goto QiqAx; y0Sxg: ZkKuR: goto UilLt; yBMbL: $c2 = $i + 1 >= $max ? "\0" : $text[$i + 1]; goto VoTl0; RSNds: goto xhYC7; goto RI8Mr; z2TEJ: $buf .= $cc1 . $cc2; goto J_iqG; U1TTY: $buf .= $c1 . $c2 . $c3 . $c4; goto f10XV; UDCvt: $buf .= $cc1 . $cc2; goto A0hCF; mtYth: if ($c2 >= "€" && $c2 <= "¿" && $c3 >= "€" && $c3 <= "¿" && $c4 >= "€" && $c4 <= "¿") { goto o0Wal; } goto ZhePb; gIE3K: $cc2 = $c1 & "?" | "€"; goto YJ2D1; kuaBz: return $text; goto tu8jL; u8201: $buf .= $cc1 . $cc2; goto ctmEe; kl1g0: if (is_string($text)) { goto W7tRA; } goto QAMyN; A0hCF: goto ejarl; goto y0Sxg; VoTl0: $c3 = $i + 2 >= $max ? "\0" : $text[$i + 2]; goto uV979; UZgrZ: pUsU7: goto LXVjF; YJ2D1: $buf .= $cc1 . $cc2; goto RSNds; HPwT0: mG7HE: goto wQTJG; BUkaM: $i++; goto QoqRB; ULB6u: $cc1 = chr(ord($c1) / 64) | "À"; goto gIE3K; szWHd: $i++; goto seth7; TkcEb: c24DN: goto LfYML; yW82j: goto xhYC7; goto TkcEb; UjrUC: o0Wal: goto U1TTY; XU2fL: F8CXp: goto yBMbL; GTnP2: goto mG7HE; goto XU2fL; ctmEe: goto OtLUx; goto UjrUC; AlRDe: $cc2 = $c1 & "?" | "€"; goto UDCvt; VCDcC: $cc2 = $c1 & "?" | "€"; goto z2TEJ; UilLt: $buf .= $c1 . $c2 . $c3; goto OcFO8; bp0AN: $max = self::strlen($text); goto QBMRT; gdbTz: } static function toWin1252($text, $option = self::WITHOUT_ICONV) { goto kEfBX; iWc38: return $text; goto gxMy7; xSE5e: foreach ($text as $k => $v) { $text[$k] = self::toWin1252($v, $option); rXXft: } goto VgE1n; gxMy7: goto UOY4a; goto d6j9e; uLOGl: goto UOY4a; goto wqCmT; uGQ9q: UOY4a: goto OWgoE; yJrzT: return $text; goto uLOGl; VgE1n: iHL1u: goto iWc38; Uy6iD: if (is_string($text)) { goto AAvjq; } goto yJrzT; wqCmT: nX8yM: goto xSE5e; AE_3N: return static::utf8_decode($text, $option); goto uGQ9q; kEfBX: if (is_array($text)) { goto nX8yM; } goto Uy6iD; d6j9e: AAvjq: goto AE_3N; OWgoE: } static function toISO8859($text, $option = self::WITHOUT_ICONV) { return self::toWin1252($text, $option); } static function toLatin1($text, $option = self::WITHOUT_ICONV) { return self::toWin1252($text, $option); } static function fixUTF8($text, $option = self::WITHOUT_ICONV) { goto r7XV1; UquPl: goto MfDgf; goto t3Iqa; t3Iqa: CJlnl: goto YRYJ0; QqVaL: C9ehW: goto fCZXq; r7XV1: if (!is_array($text)) { goto C9ehW; } goto Couv9; J3lSD: $last = $text; goto QIAov; DUgj1: return $text; goto bouzT; AyNdu: MfDgf: goto O35gF; MNBRS: return $text; goto VHW3U; Couv9: foreach ($text as $k => $v) { $text[$k] = self::fixUTF8($v, $option); H7fdh: } goto Ody80; AWuxA: return $text; goto QqVaL; QIAov: $text = self::toUTF8(static::utf8_decode($text, $option)); goto UquPl; fCZXq: if (is_string($text)) { goto osodb; } goto DUgj1; O35gF: if (!($last != $text)) { goto CJlnl; } goto J3lSD; Ody80: Amich: goto AWuxA; O2uoo: $last = ""; goto AyNdu; YRYJ0: $text = self::toUTF8(static::utf8_decode($text, $option)); goto MNBRS; bouzT: osodb: goto O2uoo; VHW3U: } static function UTF8FixWin1252Chars($text) { return str_replace(array_keys(self::$brokenUtf8ToUtf8), array_values(self::$brokenUtf8ToUtf8), $text); } static function removeBOM($str = "") { goto MOBpX; YVLNx: vzoJj: goto N_zye; N_zye: return $str; goto e2jfp; LMJwp: $str = substr($str, 3); goto YVLNx; MOBpX: if (!(substr($str, 0, 3) === pack("CCC", 0xef, 0xbb, 0xbf))) { goto vzoJj; } goto LMJwp; e2jfp: } protected static function strlen($text) { return function_exists('mb_strlen') && (int) ini_get('mbstring.func_overload') & 2 ? mb_strlen($text, '8bit') : strlen($text); } public static function normalizeEncoding($encodingLabel) { goto oS1hZ; eXtQ5: sDPdy: goto me6Y0; hnQA1: if (!empty($equivalences[$encoding])) { goto sDPdy; } goto yti0X; xKLOd: $encoding = preg_replace('/[^a-zA-Z0-9\\s]/', '', $encoding); goto rBS0q; yti0X: return 'UTF-8'; goto eXtQ5; me6Y0: return $equivalences[$encoding]; goto jg0py; rBS0q: $equivalences = array('ISO88591' => 'ISO-8859-1', 'ISO8859' => 'ISO-8859-1', 'ISO' => 'ISO-8859-1', 'LATIN1' => 'ISO-8859-1', 'LATIN' => 'ISO-8859-1', 'UTF8' => 'UTF-8', 'UTF' => 'UTF-8', 'WIN1252' => 'ISO-8859-1', 'WINDOWS1252' => 'ISO-8859-1'); goto hnQA1; oS1hZ: $encoding = strtoupper($encodingLabel); goto xKLOd; jg0py: } public static function encode($encodingLabel, $text) { goto L50zJ; L50zJ: $encodingLabel = self::normalizeEncoding($encodingLabel); goto n9OVW; Kr6On: JMF2r: goto yqbvc; DMUkZ: return self::toLatin1($text); goto Kr6On; yqbvc: return self::toUTF8($text); goto HuDUh; n9OVW: if (!($encodingLabel === 'ISO-8859-1')) { goto JMF2r; } goto DMUkZ; HuDUh: } protected static function utf8_decode($text, $option = self::WITHOUT_ICONV) { goto mNq8i; Dm8dD: goto UrMts; goto dHC3K; uK48K: $o = iconv("UTF-8", "Windows-1252" . ($option === self::ICONV_TRANSLIT ? '//TRANSLIT' : ($option === self::ICONV_IGNORE ? '//IGNORE' : '')), $text); goto Dm8dD; RMwVJ: return $o; goto ODukM; mNq8i: if ($option == self::WITHOUT_ICONV || !function_exists('iconv')) { goto rPYEa; } goto uK48K; BuItz: UrMts: goto RMwVJ; dHC3K: rPYEa: goto a409V; a409V: $o = utf8_decode(str_replace(array_keys(self::$utf8ToWin1252), array_values(self::$utf8ToWin1252), self::toUTF8($text))); goto BuItz; ODukM: } }